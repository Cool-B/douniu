# 斗牛扑克游戏 - 业务需求文档

## 1. 业务背景

### 1.1 市场分析
- **目标市场**: 中国地区微信用户
- **游戏类型**: 休闲棋牌类社交游戏
- **竞品分析**: 
  - 微信小游戏中的斗地主、德州扑克等
  - 传统棋牌APP(但需下载安装)
  - 线下斗牛游戏(受地理限制)

### 1.2 产品定位
**轻量级社交棋牌小程序**
- 无需下载,即开即用
- 好友约局,随时随地
- 规则简单,老少皆宜
- 纯娱乐性,无真实货币交易

### 1.3 商业目标
1. **用户增长**: 首年获取10万+活跃用户
2. **用户留存**: 次日留存率 > 40%, 7日留存率 > 20%
3. **用户活跃**: DAU/MAU比例 > 30%
4. **变现方式**: 
   - 广告收入(激励视频)
   - 道具销售(头像框、称号等)
   - 会员订阅(VIP功能)

---

## 2. 用户画像

### 2.1 目标用户群体

#### 主要用户 (60%)
- **年龄**: 25-45岁
- **职业**: 上班族、个体户
- **地域**: 二三线城市为主
- **特征**: 
  - 熟悉斗牛游戏规则
  - 有休闲娱乐需求
  - 微信重度用户
  - 喜欢与朋友在线互动

#### 次要用户 (30%)
- **年龄**: 45岁以上
- **职业**: 退休人员、家庭主妇
- **特征**:
  - 有闲暇时间
  - 喜欢传统棋牌游戏
  - 需要简单易懂的界面

#### 潜在用户 (10%)
- **年龄**: 18-25岁
- **职业**: 学生、年轻白领
- **特征**:
  - 游戏新手
  - 追求快节奏游戏体验
  - 社交需求强烈

### 2.2 用户需求分析

| 用户类型 | 核心需求 | 痛点 | 解决方案 |
|---------|---------|------|---------|
| 资深玩家 | 快速匹配、公平竞技 | 找不到合适对手 | AI机器人、匹配系统 |
| 新手玩家 | 学习规则、简单操作 | 不懂规则、操作复杂 | 新手教程、规则说明 |
| 社交玩家 | 好友对战、互动交流 | 缺少社交功能 | 好友系统、聊天功能 |
| 碎片时间用户 | 快速开局、随时退出 | 游戏时间长 | 快速模式、无惩罚退出 |

---

## 3. 核心业务流程

### 3.1 用户生命周期

```
新用户注册 → 首次游戏 → 活跃玩家 → 沉睡用户 → 流失用户
     ↓          ↓          ↓          ↓
  引导教程    激励奖励    日常活动    召回活动
```

### 3.2 游戏业务流程

#### 房间创建流程
```
用户发起 → 选择模式(快速/自定义)
              ↓
         生成房间号
              ↓
         等待玩家加入
              ↓
    人数满足 或 添加AI补齐
              ↓
         开始游戏
```

#### 游戏对局流程
```
所有玩家准备 → 庄家洗牌 → 庄家发牌
                              ↓
                         玩家看牌
                              ↓
                    闲家下注(1-10倍)
                              ↓
                         亮牌比大小
                              ↓
                      计算输赢并结算
                              ↓
               下一局 或 退出房间
```

#### 结算计算逻辑
```
庄家赢: 获得 (闲家下注 × 牌型倍率)
闲家赢: 获得 (自己下注 × 庄家牌型倍率)
平局: 不输不赢
```

---

## 4. 功能优先级

### 4.1 P0 核心功能 (必须实现)

#### 4.1.1 用户系统
- [x] 微信登录
- [x] 用户信息设置(昵称、头像)
- [ ] 用户积分系统
- [ ] 用户等级系统

#### 4.1.2 房间系统
- [x] 创建房间
- [x] 加入房间(房间号)
- [x] 退出房间
- [ ] 房间列表(大厅)
- [ ] 观战功能

#### 4.1.3 游戏核心
- [x] 洗牌算法
- [x] 发牌动画
- [x] 牌型识别
- [x] 庄闲角色
- [x] 下注功能
- [ ] 完整结算流程
- [ ] 倒计时功能

#### 4.1.4 基础交互
- [x] 游戏规则展示
- [x] 错误提示
- [ ] 网络异常处理
- [ ] 断线重连

### 4.2 P1 重要功能 (近期实现)

#### 4.2.1 AI系统
- [x] 添加AI玩家
- [ ] AI智能下注
- [ ] AI难度等级

#### 4.2.2 社交功能
- [ ] 好友系统
- [ ] 私聊功能
- [ ] 表情互动
- [ ] 分享邀请

#### 4.2.3 数据统计
- [ ] 游戏战绩
- [ ] 历史记录
- [ ] 胜率统计
- [ ] 排行榜

#### 4.2.4 后端集成
- [ ] WebSocket实时通信
- [ ] 用户认证API
- [ ] 房间同步API
- [ ] 游戏状态同步

### 4.3 P2 优化功能 (中期实现)

#### 4.3.1 游戏体验
- [ ] 音效系统
- [ ] 更多动画效果
- [ ] 手势操作
- [ ] 震动反馈

#### 4.3.2 个性化
- [ ] 皮肤主题
- [ ] 牌背自定义
- [ ] 头像框
- [ ] 称号系统

#### 4.3.3 运营功能
- [ ] 每日任务
- [ ] 签到奖励
- [ ] 活动系统
- [ ] 新手礼包

### 4.4 P3 长期规划 (远期考虑)

#### 4.4.1 高级功能
- [ ] 多房间模式
- [ ] 锦标赛模式
- [ ] 公会系统
- [ ] 师徒系统

#### 4.4.2 商业化
- [ ] 广告系统(激励视频)
- [ ] 虚拟商城
- [ ] VIP会员
- [ ] 礼物打赏

---

## 5. 业务规则详细说明

### 5.1 房间规则

#### 房间容量
- **标准模式**: 2-5人(1庄 + 1-4闲)
- **快速模式**: 自动补齐AI至5人
- **私人房间**: 可设置密码

#### 房间状态
| 状态 | 说明 | 允许操作 |
|------|------|---------|
| 等待中 | 未开始游戏 | 加入、退出、准备 |
| 游戏中 | 正在进行游戏 | 游戏操作、观战 |
| 结算中 | 显示结算结果 | 查看战绩、继续/退出 |

#### 房间创建规则
- 房间号: 6位数字(100000-999999)
- 房间ID: 时间戳(唯一标识)
- 创建者自动成为庄家
- 房间有效期: 30分钟无操作自动解散

### 5.2 角色规则

#### 庄家职责
- 发起游戏开始
- 执行洗牌操作
- 执行发牌操作
- 执行结算操作
- 与所有闲家对战

#### 闲家职责
- 选择下注倍数(1-10)
- 准备后等待开始
- 查看自己的手牌
- 与庄家单独比牌

#### AI机器人
- 自动准备
- 随机下注(1-5倍为主)
- 自动参与所有流程
- 无需等待操作

### 5.3 游戏规则

#### 牌型定义详解

**1. 五小牛 (Five Little)**
- 条件: 5张牌点数总和 ≤ 10
- 倍率: ×7
- 示例: A + A + 2 + 3 + 3 = 10

**2. 五花牛 (Five Face)**
- 条件: 5张全部为JQK
- 倍率: ×6
- 示例: J + J + Q + Q + K

**3. 炸弹 (Bomb)**
- 条件: 5张牌仅包含2种点数
- 倍率: ×3
- 示例: 8 + 8 + 8 + K + K

**4. 牛牛 (Niu Niu)**
- 条件: 3张牌和为10的倍数,剩余2张和也为10的倍数
- 倍率: ×5
- 示例: 3 + 7 + 10 (=20) + 5 + 5 (=10)

**5. 牛九至牛一 (Niu 9-1)**
- 条件: 3张牌和为10的倍数,剩余2张和的个位数
- 倍率: ×4(牛九) 递减至 ×1(牛一)
- 示例: 2 + 3 + 5 (=10) + 7 + 2 (=9) → 牛九

**6. 无牛 (No Niu)**
- 条件: 无法找到3张牌和为10的倍数
- 倍率: ×1
- 比较: 比最大单牌

#### 比牌规则优先级
```
1. 特殊牌型等级 (五小牛 > 五花牛 > 炸弹 > 牛牛)
2. 牛点数大小 (牛九 > 牛八 > ... > 牛一 > 无牛)
3. 最大单牌点数 (K > Q > J > 10 > ... > A)
4. 最大单牌花色 (黑桃 > 红桃 > 梅花 > 方块)
```

#### 结算公式
```
庄家赢:
  获得积分 = 闲家下注倍数 × 庄家牌型倍率

闲家赢:
  获得积分 = 闲家下注倍数 × 闲家牌型倍率

闲家输:
  扣除积分 = 闲家下注倍数 × 庄家牌型倍率
```

#### 特殊情况处理
- **平局**: 完全相同的牌不扣分不加分
- **断线**: 视为弃牌,自动扣除最小倍数
- **超时**: 10秒未操作自动选择最小倍数

### 5.4 积分规则

#### 初始积分
- 新用户: 1000分
- 每日登录: +50分
- 完成新手教程: +200分

#### 积分获取
- 对局获胜: 根据结算公式
- 每日签到: 50-200分
- 完成任务: 按任务奖励
- 邀请好友: 100分/人

#### 积分消耗
- 对局失败: 根据结算公式
- 购买道具: 按商品定价
- 创建房间: 免费(可能后期收费)

#### 破产保护
- 积分 < 100: 系统赠送200分(每日1次)
- 观看广告: 获得100分(每日3次)

---

## 6. 业务指标与KPI

### 6.1 用户增长指标
- **新增用户数**: 日新增 > 1000人
- **注册转化率**: > 80% (从进入小程序到完成注册)
- **分享率**: > 15% (用户主动分享游戏)

### 6.2 用户活跃指标
- **DAU**: 日活跃用户 > 5000人
- **MAU**: 月活跃用户 > 50000人
- **人均游戏时长**: > 15分钟/日
- **人均对局数**: > 5局/日

### 6.3 用户留存指标
- **次日留存**: > 40%
- **7日留存**: > 20%
- **30日留存**: > 10%

### 6.4 收入指标
- **付费率**: > 5%
- **ARPPU**: > 20元/月
- **广告收入**: > 10000元/月

---

## 7. 风险评估

### 7.1 业务风险

| 风险类型 | 描述 | 影响 | 应对措施 |
|---------|------|------|---------|
| 合规风险 | 被认定为赌博游戏 | 高 | 不使用真实货币,仅积分娱乐 |
| 竞品风险 | 同类游戏竞争激烈 | 中 | 强化社交属性,优化用户体验 |
| 用户流失 | 新鲜感过后用户流失 | 中 | 持续更新内容,运营活动 |
| 盈利困难 | 变现模式不清晰 | 中 | 多元化收入来源 |

### 7.2 技术风险

| 风险类型 | 描述 | 影响 | 应对措施 |
|---------|------|------|---------|
| 服务器压力 | 高并发导致服务器崩溃 | 高 | 负载均衡,CDN加速 |
| 数据安全 | 用户数据泄露 | 高 | 加密存储,HTTPS通信 |
| 作弊风险 | 外挂、刷分等 | 中 | 服务端验证,反作弊系统 |
| 兼容性 | 不同设备兼容性问题 | 低 | 多设备测试 |

### 7.3 运营风险

| 风险类型 | 描述 | 影响 | 应对措施 |
|---------|------|------|---------|
| 用户投诉 | 游戏不公平、Bug等 | 中 | 及时响应,快速修复 |
| 恶意用户 | 辱骂、刷屏等 | 低 | 举报系统,封号机制 |
| 内容审核 | 用户昵称、头像违规 | 低 | 自动审核+人工审核 |

---

## 8. 成功标准

### 8.1 MVP阶段成功标准 (前3个月)
- ✅ 核心游戏流程完整可玩
- ✅ 无严重Bug,用户体验流畅
- □ 获得100+真实用户反馈
- □ 7日留存率 > 15%

### 8.2 成长阶段成功标准 (3-6个月)
- □ DAU > 1000
- □ 用户满意度 > 4.0分(5分制)
- □ 完成后端集成
- □ 上线社交功能

### 8.3 成熟阶段成功标准 (6-12个月)
- □ MAU > 50000
- □ 付费率 > 5%
- □ 月收入 > 50000元
- □ 排行榜进入小程序游戏前100

---

## 9. 竞品分析

### 9.1 直接竞品

#### 微信小游戏 - 欢乐斗牛
- **优势**: 腾讯官方、用户基数大、社交功能完善
- **劣势**: 界面复杂、广告多
- **借鉴**: 社交功能、匹配机制
- **差异化**: 更简洁界面、无广告打扰

#### 微信小游戏 - 斗牛大亨
- **优势**: 画面精美、玩法多样
- **劣势**: 加载慢、付费压力大
- **借鉴**: 动画效果、奖励机制
- **差异化**: 快速加载、公平竞技

### 9.2 间接竞品

#### 斗地主、德州扑克等棋牌游戏
- **借鉴**: 成熟的游戏流程、等级系统
- **差异化**: 斗牛规则更简单、对局更快速

---

## 10. 用户反馈渠道

### 10.1 收集方式
- 小程序内反馈按钮
- 微信客服消息
- 用户社群(微信群)
- 应用商店评价

### 10.2 反馈处理流程
```
用户反馈 → 分类整理 → 优先级评估
              ↓
        高优先级立即处理
              ↓
        中低优先级纳入迭代计划
              ↓
        处理完成后通知用户
```

---

**下一步**: 请参阅《项目需求文档-功能需求.md》了解详细功能规格
