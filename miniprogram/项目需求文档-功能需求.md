# 斗牛扑克游戏 - 功能需求详细说明

## 1. 功能模块总览

```
斗牛游戏小程序
├── 用户模块
│   ├── 登录注册
│   ├── 个人信息
│   └── 用户设置
├── 房间模块
│   ├── 创建房间
│   ├── 加入房间
│   ├── 房间列表
│   └── 房间管理
├── 游戏模块
│   ├── 游戏流程
│   ├── 牌型识别
│   ├── 下注系统
│   └── 结算系统
├── 社交模块
│   ├── 好友系统
│   ├── 聊天功能
│   └── 分享邀请
└── 系统模块
    ├── 规则说明
    ├── 设置中心
    └── 帮助反馈
```

---

## 2. 用户模块

### 2.1 登录注册功能

#### 功能描述

用户通过微信授权快速登录,设置昵称和头像后即可开始游戏。

#### 详细需求

**FR-USER-001: 微信登录**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户首次打开小程序或登录态失效
- **前置条件**: 用户已安装微信
- **业务流程**:
  1. 小程序调用 `wx.login()` 获取临时 code
  2. 将 code 发送到后端服务器
  3. 后端通过 code 换取 openid 和 session_key
  4. 后端生成 token 返回给前端
  5. 前端存储 token 用于后续请求
- **输入**: 微信授权 code
- **输出**: userInfo 对象(id, openid, token 等)
- **异常处理**:
  - 网络异常: 提示"网络错误,请重试"
  - 授权失败: 提示"登录失败,请稍后再试"
  - 后端异常: 提示"服务器繁忙,请稍后再试"
- **相关文件**: `pages/index/index.ts:196-248`

**FR-USER-002: 头像选择**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户点击头像区域
- **业务流程**:
  1. 用户点击头像
  2. 调用微信头像选择器 `open-type="chooseAvatar"`
  3. 用户选择图片
  4. 触发 `bindchooseavatar` 事件
  5. 获取头像临时路径
  6. 更新页面显示
- **输入**: 微信头像选择器返回的临时路径
- **输出**: 头像 URL
- **限制**: 图片大小 < 2MB
- **相关文件**: `pages/index/index.wxml:50-55`

**FR-USER-003: 昵称设置**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户在输入框中输入
- **业务流程**:
  1. 用户在输入框输入昵称
  2. 触发 `bindinput` 事件
  3. 实时更新数据模型
- **输入**: 用户输入的文本
- **输出**: 昵称字符串
- **验证规则**:
  - 长度: 2-12 个字符
  - 不允许特殊字符
  - 不允许纯数字
  - 不允许敏感词
- **错误提示**:
  - 长度不足: "昵称至少 2 个字符"
  - 包含特殊字符: "昵称不能包含特殊字符"
- **相关文件**: `pages/index/index.wxml:57-63`

**FR-USER-004: 完成注册**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户点击"开始游戏"按钮
- **前置条件**: 已选择头像和输入昵称
- **业务流程**:
  1. 验证昵称和头像是否有效
  2. 调用登录 API
  3. 存储用户信息到本地 Storage
  4. 切换到主页界面
- **输入**: 昵称、头像 URL、微信 code
- **输出**: 完整的 userInfo 对象
- **异常处理**:
  - 昵称未填写: 提示"请输入昵称"
  - 头像未选择: 使用默认头像
  - 网络错误: 提示"登录失败,请重试"
- **相关文件**: `pages/index/index.ts:196-248`

### 2.2 个人信息管理

#### 功能描述

用户可以查看和修改个人信息,包括昵称、头像、等级、积分等。

#### 详细需求

**FR-USER-005: 查看个人信息**

- **优先级**: P1
- **状态**: ⚠️ 部分实现(仅显示昵称和头像)
- **显示内容**:
  - 头像
  - 昵称
  - 用户 ID
  - 当前积分
  - 用户等级
  - 游戏战绩(胜/负/平)
  - 胜率
- **界面位置**: 主页左上角用户卡片
- **相关文件**: `pages/index/index.wxml:29-42`

**FR-USER-006: 修改昵称**

- **优先级**: P2
- **状态**: ❌ 未实现
- **触发条件**: 用户点击昵称编辑按钮
- **业务流程**:
  1. 弹出昵称编辑对话框
  2. 用户输入新昵称
  3. 调用修改昵称 API
  4. 更新本地 Storage
  5. 刷新界面显示
- **限制**: 7 天内只能修改 1 次
- **验证**: 同昵称设置规则

**FR-USER-007: 修改头像**

- **优先级**: P2
- **状态**: ❌ 未实现
- **触发条件**: 用户点击头像编辑按钮
- **业务流程**: 同头像选择流程

### 2.3 用户设置

**FR-USER-008: 设置中心**

- **优先级**: P2
- **状态**: ❌ 未实现
- **设置项**:
  - 音效开关
  - 震动开关
  - 自动准备
  - 横屏锁定
  - 消息通知
- **存储**: 本地 Storage

---

## 3. 房间模块

### 3.1 创建房间功能

#### 功能描述

用户可以创建游戏房间,等待其他玩家加入或添加 AI 机器人开始游戏。

#### 详细需求

**FR-ROOM-001: 快速开始**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户点击主页"快速开始"按钮
- **业务流程**:
  1. 调用创建房间 API
  2. 自动生成房间号(6 位数字)
  3. 创建者自动成为庄家(userType=1)
  4. 创建 8 个空座位(userType=4)
  5. 保存房间信息到本地
  6. 跳转到游戏页面
- **输入**: userId, roomType=2(快速模式)
- **输出**: roomInfo 对象
- **异常处理**:
  - 创建失败: 提示"创建房间失败,请重试"
  - 网络错误: 提示"网络异常"
- **相关文件**: `pages/index/index.ts:98-129`
- **API**: `POST /poker/createRoom`

**FR-ROOM-002: 自定义房间**

- **优先级**: P1
- **状态**: ❌ 未实现
- **触发条件**: 用户点击"自定义房间"
- **可配置项**:
  - 房间人数(2-9 人)
  - 底注大小(1/2/5/10)
  - 是否允许中途加入
  - 是否允许观战
  - 房间密码(可选)
- **业务流程**: 类似快速开始,但携带配置参数

**FR-ROOM-003: 房间信息展示**

- **优先级**: P0
- **状态**: ✅ 已实现
- **显示内容**:
  - 房间号(右上角)
  - 当前人数/最大人数
  - 庄家信息
  - 各玩家状态(准备/未准备)
  - 游戏状态(等待/游戏中/结算)
- **相关文件**: `pages/card_game/card_game.wxml:104-109`

### 3.2 加入房间功能

**FR-ROOM-004: 通过房间号加入**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户点击"加入游戏"按钮
- **业务流程**:
  1. 弹出房间号输入模态框
  2. 用户输入 6 位房间号
  3. 验证房间号格式
  4. 调用加入房间 API
  5. 检查房间是否存在
  6. 检查房间是否已满
  7. 将用户添加到空座位
  8. 跳转到游戏页面
- **输入**: roomNumber(6 位数字)
- **输出**: 更新后的 roomInfo
- **验证规则**:
  - 必须为 6 位数字
  - 房间必须存在
  - 房间未满员
  - 房间未在游戏中(或允许中途加入)
- **异常处理**:
  - 房间不存在: "房间不存在"
  - 房间已满: "房间已满"
  - 格式错误: "请输入正确的房间号"
- **相关文件**:
  - `pages/index/index.ts:131-172`
  - `components/room-modal/room-modal.ts`
- **API**: `POST /poker/joinRoom`

**FR-ROOM-005: 房间列表加入**

- **优先级**: P1
- **状态**: ❌ 未实现
- **触发条件**: 用户点击"大厅"按钮
- **显示内容**:
  - 所有公开房间列表
  - 房间号、房间名称
  - 当前人数/最大人数
  - 房间状态
- **筛选条件**:
  - 未满员房间
  - 未开始游戏的房间
- **操作**: 点击房间卡片加入

### 3.3 房间管理功能

**FR-ROOM-006: 添加 AI 机器人**

- **优先级**: P0
- **状态**: ✅ 已实现(前端 UI)
- **触发条件**: 庄家点击空座位的"添加机器人"按钮
- **业务流程**:
  1. 检查是否有空座位
  2. 生成机器人 ID 和名称
  3. 将机器人添加到座位(userType=3)
  4. 设置机器人状态为准备(status=2)
  5. 更新房间信息
- **限制**:
  - 只有庄家可以添加
  - 至少保留 1 个位置给真人玩家
- **相关文件**: `pages/card_game/card_game.wxml:26-30`
- **API**: `POST /poker/addAssistantOrChangeSeat`

**FR-ROOM-007: 退出房间**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 用户点击"退出房间"按钮
- **业务流程**:
  1. 弹出确认对话框
  2. 用户确认退出
  3. 如果游戏中,结算当前积分
  4. 从房间玩家列表移除
  5. 如果是庄家,转让庄家身份或解散房间
  6. 清除本地房间信息
  7. 返回主页
- **异常处理**:
  - 游戏中退出: 扣除最大下注倍数积分
- **相关文件**: `pages/card_game/card_game.ts:206-219`
- **API**: `POST /poker/exitRoom`

**FR-ROOM-008: 解散房间**

- **优先级**: P1
- **状态**: ❌ 未实现
- **触发条件**:
  - 庄家主动解散
  - 所有玩家退出
  - 30 分钟无操作
- **业务流程**:
  1. 通知所有玩家房间解散
  2. 结算未完成的对局
  3. 删除房间数据
  4. 所有玩家返回主页

---

## 4. 游戏模块

### 4.1 游戏流程控制

#### 详细需求

**FR-GAME-001: 准备功能**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 闲家点击"准备"按钮
- **业务流程**:
  1. 验证是否已选择下注倍数
  2. 修改玩家状态为准备(status=2)
  3. 锁定下注倍数
  4. 通知其他玩家
- **限制**:
  - 庄家无需准备
  - 未选择下注不能准备
  - 准备后不能修改下注
- **相关文件**: `pages/card_game/card_game.ts:359-383`

**FR-GAME-002: 取消准备**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 已准备的闲家点击"取消准备"
- **业务流程**:
  1. 修改玩家状态为未准备(status=1)
  2. 解锁下注倍数选择
  3. 通知其他玩家
- **限制**: 游戏已开始不能取消

**FR-GAME-003: 开始游戏**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 庄家点击"开始游戏"按钮
- **前置条件**:
  - 至少 2 名玩家(包括庄家)
  - 所有闲家已准备
- **业务流程**:
  1. 验证准备条件
  2. 修改房间状态 isStart=true
  3. 生成游戏 ID
  4. 记录游戏开始时间
  5. 启用洗牌和发牌按钮
- **异常处理**:
  - 人数不足: "至少需要 2 名玩家"
  - 有未准备玩家: "等待所有玩家准备"
- **相关文件**: `pages/card_game/card_game.ts:148-177`
- **API**: `POST /poker/startGame`

**FR-GAME-004: 洗牌功能**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 庄家点击"洗牌"按钮
- **业务流程**:
  1. 生成 52 张牌(4 花色 × 13 点数)
  2. 使用 Fisher-Yates 算法洗牌
  3. 更新页面牌堆显示
- **算法**: Fisher-Yates shuffle
- **时间复杂度**: O(n)
- **相关文件**: `pages/card_game/card_game.ts:221-242`

**FR-GAME-005: 发牌功能**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 庄家点击"发牌"按钮
- **前置条件**: 已洗牌
- **业务流程**:
  1. 修改房间状态 isStartDeal=true
  2. 筛选需要发牌的玩家(已准备或庄家)
  3. 轮流给每位玩家发 1 张牌
  4. 每张牌间隔 300ms
  5. 每人发满 5 张牌
  6. 修改状态 isDealComplete=true
  7. 自动触发牌型识别
- **动画**: 卡牌从牌堆飞向玩家位置
- **相关文件**: `pages/card_game/card_game.ts:244-300`

**FR-GAME-006: 亮牌功能**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**:
  - 庄家点击"亮牌"按钮
  - 玩家点击自己的手牌
- **业务流程**:
  1. 设置玩家 lookHand=true
  2. 显示牌面图片
  3. 检查是否所有人已看牌
- **显示**:
  - 自己的牌: 显示牌面
  - 他人的牌: 显示牌背(或已亮则显示牌面)
- **相关文件**: `pages/card_game/card_game.ts:322-344`

**FR-GAME-007: 结算功能**

- **优先级**: P0
- **状态**: ⚠️ 部分实现(仅牌型识别,未实现积分结算)
- **触发条件**: 庄家点击"结算"按钮
- **前置条件**: 所有牌已发完
- **业务流程**:
  1. 遍历所有玩家手牌
  2. 调用牌型识别算法
  3. 比较庄家与每个闲家的牌型
  4. 计算输赢积分
  5. 更新玩家积分
  6. 显示结算界面
  7. 清空手牌,准备下一局
- **结算公式**: 见业务需求文档 5.3 节
- **相关文件**: `pages/card_game/card_game.ts:302-320, 394-415`

### 4.2 牌型识别系统

#### 功能描述

自动识别玩家手牌的牌型等级和点数,作为比牌和结算的依据。

#### 详细需求

**FR-GAME-008: 牛牌识别**

- **优先级**: P0
- **状态**: ✅ 已实现
- **算法逻辑**:
  1. 遍历所有 3 张牌的组合(C(5,3)=10 种)
  2. 检查每组 3 张牌之和是否为 10 的倍数
  3. 如果是,计算剩余 2 张牌之和的个位数(牛点)
  4. 选择牛点最大的组合
  5. 如果牛点相同,选择最大单牌最大的组合
- **输入**: 5 张牌的数组
- **输出**: PokeData 对象
  ```typescript
  {
    hasNiu: true,
    pointNumber: 9,    // 牛点(0-9)
    maxNumber: 13,     // 最大单牌
    suit: 'Spade',     // 最大单牌花色
    isBoom: false,
    isDoubleTen: false
  }
  ```
- **相关文件**: `pages/card_game/card_game.ts:477-559`

**FR-GAME-009: 无牛识别**

- **优先级**: P0
- **状态**: ✅ 已实现
- **算法逻辑**:
  1. 遍历所有 3 张牌组合
  2. 无任何组合和为 10 的倍数
  3. 返回最大单牌作为比牌依据
- **输出**:
  ```typescript
  {
    hasNiu: false,
    pointNumber: 0,
    maxNumber: 13,
    suit: 'Spade',
    isBoom: false,
    isDoubleTen: false
  }
  ```

**FR-GAME-010: 炸弹识别**

- **优先级**: P0
- **状态**: ✅ 已实现
- **算法逻辑**:
  1. 提取 5 张牌的所有唯一点数
  2. 如果唯一点数只有 2 种,判定为炸弹
- **示例**: [8,8,8,K,K] → 只有 8 和 K 两种点数 → 炸弹
- **相关文件**: `pages/card_game/card_game.ts:418-421`

**FR-GAME-011: 五小牛识别**

- **优先级**: P1
- **状态**: ❌ 未实现
- **算法逻辑**:
  1. 计算 5 张牌点数总和
  2. 如果总和 ≤ 10,判定为五小牛
- **示例**: [A,A,2,3,3] → 1+1+2+3+3=10 → 五小牛

**FR-GAME-012: 五花牛识别**

- **优先级**: P1
- **状态**: ❌ 未实现
- **算法逻辑**:
  1. 检查 5 张牌是否全部为 JQK
  2. 如果是,判定为五花牛
- **示例**: [J,J,Q,Q,K] → 全部为花牌 → 五花牛

**FR-GAME-013: 双十识别**

- **优先级**: P1
- **状态**: ⚠️ 已实现但有 Bug
- **Bug 描述**: 判断逻辑错误,见代码 545 行
- **算法逻辑**(应该是):
  1. 检查 5 张牌中是否恰好有 2 张 10
  2. 检查剩余 3 张牌之和是否为 10 的倍数
- **相关文件**: `pages/card_game/card_game.ts:423-431, 545`

### 4.3 下注系统

**FR-GAME-014: 选择下注倍数**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发条件**: 闲家点击下注选择器
- **可选倍数**: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10
- **业务流程**:
  1. 闲家点击 Picker 组件
  2. 选择下注倍数
  3. 更新页面显示"当前下注:X"
  4. 数据存储到 selectedValue
- **限制**:
  - 庄家无需下注
  - 准备后不能修改
  - 游戏中不能修改
- **相关文件**: `pages/card_game/card_game.wxml:51-56`

**FR-GAME-015: 下注验证**

- **优先级**: P1
- **状态**: ❌ 未实现
- **验证规则**:
  - 积分不足: 禁止下注超过当前积分的倍数
  - 庄家积分: 需覆盖所有闲家可能的最大输赢
- **提示**: 积分不足时显示红色警告

### 4.4 比牌系统

**FR-GAME-016: 牌型比较**

- **优先级**: P0
- **状态**: ⚠️ 算法已实现,结算流程未完整
- **比较规则**: 见业务需求文档 5.3 节
- **实现位置**: 结算函数中
- **需要实现**:
  1. 遍历所有闲家
  2. 逐一与庄家比较
  3. 根据牌型规则判定胜负
  4. 计算积分变化
  5. 更新玩家积分
  6. 生成结算报告

**FR-GAME-017: 结算界面**

- **优先级**: P1
- **状态**: ❌ 未实现
- **显示内容**:
  - 本局对战结果
  - 每位玩家的牌型
  - 积分变化(+/-多少)
  - 当前总积分
  - "继续游戏"和"退出房间"按钮
- **动画**:
  - 胜利玩家金币飞入动画
  - 失败玩家金币飞出动画

---

## 5. 社交模块

### 5.1 好友系统

**FR-SOCIAL-001: 好友列表**

- **优先级**: P1
- **状态**: ❌ 未实现
- **功能**:
  - 查看好友列表
  - 显示好友在线状态
  - 显示好友当前游戏状态
  - 快速邀请好友

**FR-SOCIAL-002: 添加好友**

- **优先级**: P1
- **状态**: ❌ 未实现
- **方式**:
  - 通过用户 ID 搜索
  - 对局后添加
  - 微信好友导入

**FR-SOCIAL-003: 邀请好友**

- **优先级**: P1
- **状态**: ❌ 未实现
- **业务流程**:
  1. 用户在房间内点击"邀请好友"
  2. 选择好友或生成邀请链接
  3. 发送微信消息或分享卡片
  4. 好友点击链接直接加入房间

### 5.2 聊天功能

**FR-SOCIAL-004: 房间聊天**

- **优先级**: P2
- **状态**: ❌ 未实现
- **功能**:
  - 文本消息
  - 快捷语音(预设语音)
  - 表情包
- **限制**:
  - 每分钟最多 10 条消息
  - 自动过滤敏感词

**FR-SOCIAL-005: 互动表情**

- **优先级**: P2
- **状态**: ❌ 未实现
- **功能**:
  - 预设互动表情(点赞、鼓掌等)
  - 对指定玩家发送
  - 显示在玩家头像附近

### 5.3 分享功能

**FR-SOCIAL-006: 分享房间**

- **优先级**: P1
- **状态**: ❌ 未实现
- **触发**: 点击"分享"按钮
- **方式**:
  - 转发给微信好友/群
  - 生成房间二维码
- **内容**: 房间号、当前人数、邀请语

**FR-SOCIAL-007: 分享战绩**

- **优先级**: P2
- **状态**: ❌ 未实现
- **触发**: 结算后点击"分享"
- **内容**: 战绩截图、牌型展示

---

## 6. 系统模块

### 6.1 规则说明

**FR-SYS-001: 游戏规则展示**

- **优先级**: P0
- **状态**: ✅ 已实现
- **触发**:
  - 主页点击"游戏规则"按钮
  - 游戏页点击"?"图标
- **内容**:
  - 基本规则(4 条)
  - 牌型说明(9 种牌型+图示)
  - 结算规则
  - 游戏技巧
- **交互**: 模态框形式,可滚动查看
- **相关文件**: `components/rules-modal/`

**FR-SYS-002: 新手教程**

- **优先级**: P1
- **状态**: ❌ 未实现
- **触发**: 首次进入游戏
- **形式**: 分步引导+高亮提示
- **步骤**:
  1. 介绍界面布局
  2. 演示创建/加入房间
  3. 演示下注和准备
  4. 演示查看手牌
  5. 介绍牌型规则
  6. 完成首局游戏

### 6.2 设置中心

**FR-SYS-003: 系统设置**

- **优先级**: P2
- **状态**: ❌ 未实现
- **设置项**:
  - 音效音量(0-100)
  - 背景音乐开关
  - 震动反馈开关
  - 横屏锁定
  - 自动准备
  - 快速结算(跳过动画)
  - 消息通知

### 6.3 帮助与反馈

**FR-SYS-004: 帮助中心**

- **优先级**: P2
- **状态**: ❌ 未实现
- **内容**:
  - 常见问题(FAQ)
  - 操作指南
  - 联系客服
  - 版本信息

**FR-SYS-005: 问题反馈**

- **优先级**: P2
- **状态**: ❌ 未实现
- **功能**:
  - 文本描述问题
  - 上传截图
  - 选择问题类型
  - 提交反馈
- **处理**: 后台收集,人工处理

**FR-SYS-006: 版本更新**

- **优先级**: P2
- **状态**: ❌ 未实现
- **功能**:
  - 检测新版本
  - 强制更新/可选更新
  - 更新日志展示

---

## 7. 数据统计模块

### 7.1 个人数据

**FR-STAT-001: 游戏战绩**

- **优先级**: P1
- **状态**: ❌ 未实现
- **统计指标**:
  - 总对局数
  - 胜/负/平场次
  - 胜率
  - 最高连胜
  - 当日对局数

**FR-STAT-002: 历史记录**

- **优先级**: P2
- **状态**: ❌ 未实现
- **显示内容**:
  - 最近 20 局记录
  - 每局详情(时间、对手、结果、牌型)
  - 可回放(查看每局手牌)

**FR-STAT-003: 积分记录**

- **优先级**: P1
- **状态**: ❌ 未实现
- **显示内容**:
  - 积分变化曲线图
  - 收入/支出统计
  - 最大单局盈利/亏损

### 7.2 排行榜

**FR-STAT-004: 好友排行**

- **优先级**: P2
- **状态**: ❌ 未实现
- **排序维度**:
  - 积分排行
  - 胜率排行
  - 对局数排行

**FR-STAT-005: 全服排行**

- **优先级**: P2
- **状态**: ❌ 未实现
- **排行榜类型**:
  - 周排行
  - 月排行
  - 总排行
- **显示**: 前 100 名,以及自己的排名

---

## 8. 运营功能模块

### 8.1 任务系统

**FR-OPS-001: 每日任务**

- **优先级**: P2
- **状态**: ❌ 未实现
- **任务类型**:
  - 完成 N 局游戏(N=3,5,10)
  - 获胜 N 次
  - 达成特定牌型(如牛牛)
  - 邀请 N 个好友
- **奖励**: 积分、道具

**FR-OPS-002: 成就系统**

- **优先级**: P2
- **状态**: ❌ 未实现
- **成就类型**:
  - 累计胜场数
  - 连胜记录
  - 特殊牌型次数
  - 积分里程碑
- **奖励**: 称号、头像框

### 8.2 活动系统

**FR-OPS-003: 签到活动**

- **优先级**: P2
- **状态**: ❌ 未实现
- **功能**:
  - 每日签到
  - 连续签到奖励递增
  - 补签功能(看广告)

**FR-OPS-004: 限时活动**

- **优先级**: P2
- **状态**: ❌ 未实现
- **类型**:
  - 双倍积分时段
  - 节日特别活动
  - 周末狂欢

---

## 9. 非功能性需求

### 9.1 性能需求

**NFR-PERF-001: 响应时间**

- 页面加载: < 2 秒
- 操作响应: < 300ms
- 动画帧率: ≥ 60fps
- API 响应: < 1 秒

**NFR-PERF-002: 资源占用**

- 小程序包大小: < 2MB
- 内存占用: < 100MB
- 流量消耗: < 10MB/小时

### 9.2 兼容性需求

**NFR-COMPAT-001: 设备兼容**

- 支持 iOS 10+
- 支持 Android 5.0+
- 支持微信 7.0+
- 适配主流屏幕尺寸

**NFR-COMPAT-002: 网络兼容**

- 支持 WiFi
- 支持 4G/5G
- 弱网优化(3G 可用)

### 9.3 安全需求

**NFR-SEC-001: 数据安全**

- 所有通信使用 HTTPS
- 敏感数据加密存储
- Token 定期刷新
- 防止重放攻击

**NFR-SEC-002: 防作弊**

- 服务端验证所有关键操作
- 牌型计算在服务端进行
- 异常行为检测
- 封号机制

---

## 10. 功能实现优先级路线图

### 第一阶段: MVP 完善 (1-2 周)

- [ ] 完善后端 API 对接
- [ ] 实现完整结算流程
- [ ] 修复双十识别 Bug
- [ ] 实现断线重连
- [ ] 添加倒计时功能

### 第二阶段: 核心功能 (2-3 周)

- [ ] 实现积分系统
- [ ] 实现用户等级
- [ ] 添加五小牛、五花牛识别
- [ ] 实现结算界面
- [ ] 完善错误处理

### 第三阶段: 社交功能 (2-3 周)

- [ ] 实现好友系统
- [ ] 实现邀请功能
- [ ] 实现房间聊天
- [ ] 实现分享功能

### 第四阶段: 数据统计 (1-2 周)

- [ ] 实现战绩统计
- [ ] 实现历史记录
- [ ] 实现排行榜

### 第五阶段: 运营功能 (2-3 周)

- [ ] 实现任务系统
- [ ] 实现签到功能
- [ ] 实现活动系统

---

**下一步**: 请参阅《项目需求文档-技术架构.md》了解实现细节
